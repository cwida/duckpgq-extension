

require duckpgq

statement ok
CREATE TABLE nodes (id INTEGER); INSERT INTO nodes VALUES (1), (2), (3);

statement ok
CREATE TABLE edges (src INTEGER, dst INTEGER);

statement ok
-CREATE PROPERTY GRAPH testgraph
  	VERTEX TABLES (
	    nodes LABEL N
	)
	EDGE TABLES (
  	    edges SOURCE KEY (src) REFERENCES nodes (id)
        	  DESTINATION KEY (dst) REFERENCES nodes (id)
  		  LABEL E
);

statement ok
-FROM GRAPH_TABLE (testgraph MATCH (:N)-[e:E]->(n2:N));

statement error
-FROM GRAPH_TABLE (testgraph MATCH (:N)-[e:E]->(:N));
----
Constraint Error: Ambiguous anonymous variable pattern detected for label 'n'. Please provide an explicit variable name.

statement error
-FROM GRAPH_TABLE (testgraph MATCH (:N)-[e:E]->(n:N));
----
Constraint Error: Conflicting variable bindings: anonymous node with variable 'n' was already assigned. Provide explicit variable names for all occurrences.

statement error
-FROM GRAPH_TABLE (testgraph MATCH (n:N)-[e:E]->(:N));
----
Constraint Error: Ambiguous anonymous variable pattern detected for label 'n'. Please provide an explicit variable name.

statement error
-FROM GRAPH_TABLE (testgraph MATCH (:N)-[n:E]->(:N));
----
Constraint Error: Conflicting variable bindings: anonymous node with variable 'n' was already assigned. Provide explicit variable names for all occurrences.


